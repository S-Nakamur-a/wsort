(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4134:function(t,e,a){Promise.resolve().then(a.bind(a,2986))},2986:function(t,e,a){"use strict";a.r(e),a.d(e,{GameBoard:function(){return d}});var r=a(3827),o=a(4090);class s{isEmpty(){return 0===this.waters.length}isFull(){return this.waters.length===this.getMaxCapacitySize()}hasCapacity(){return this.waters.length<this.getMaxCapacitySize()}getCapacitySize(){return this.getMaxCapacitySize()-this.waters.length}getMaxCapacitySize(){return s.maxCapacitySize}static getEmptyBottle(){return new s([])}getTopWater(){return this.isEmpty()?null:this.waters[this.waters.length-1]}removeTopWater(){return new s(this.isEmpty()?[]:this.waters.slice(0,this.waters.length-1))}addWater(t){var e;return new s(this.isEmpty()||(null===(e=this.getTopWater())||void 0===e?void 0:e.isSameColor(t))?[...this.waters,t]:this.waters.slice())}constructor(t){this.waters=t}}s.maxCapacitySize=4;class n{isSameColor(t){return this.colorHexCode===t.colorHexCode}static allColors(){return["#E6194B","#3CB44B","#FFE119","#0082C8","#F58231","#911EB4","#46F0F0","#F032E6","#D2F53C","#FABEBE","#008080","#AA6E28","#FFFAC8","#800000","#AAFFC3","#808000","#FFD8B1","#000080","#808080","#469990"]}static fromColorNumber(t){if(t<0||t>=n.maxColors())throw Error("index is out of range");return new n(n.allColors()[t])}static maxColors(){return n.allColors().length}constructor(t){this.colorHexCode=t}}class l{static empty(){return new l([],0)}static random(t){let e=Array.from({length:t},(t,e)=>Array.from({length:s.maxCapacitySize},()=>n.fromColorNumber(e))).flat().sort(()=>Math.random()-.5),a=Array.from({length:t},(t,a)=>{let r=a*s.maxCapacitySize,o=r+s.maxCapacitySize;return new s(e.slice(r,o))});return a.push(s.getEmptyBottle()),a.push(s.getEmptyBottle()),new l(a,t)}constructor(t,e){this.bottles=t,this.nColors=e}}var i=function(t){let[e,a]=(0,o.useState)(l.empty()),[r,n]=(0,o.useState)([]),[i,c]=(0,o.useState)(-1),m=t=>{let e=l.random(t);n([e]),a(e),c(0)};return(0,o.useEffect)(()=>{m(t)},[t]),{gameState:e,updateGameState:t=>{let e={...t,bottles:t.bottles.map(t=>new s([...t.waters]))},o=r.slice(0,i+1).concat(e);o.length>300&&o.shift(),n(o),c(o.length-1),a(e)},undoGameState:()=>{if(i>0){let t=i-1;c(t),a(r[t])}},resetGameState:()=>{let t=r[0];n([t]),a(t),c(0)},startNewGame:m}};let c=(t,e)=>{var a;return!(t===e||t.isEmpty()||e.isFull())&&(!!e.isEmpty()||(null===(a=e.getTopWater())||void 0===a?void 0:a.isSameColor(t.getTopWater()))===!0)},m=(t,e)=>{for(;c(t,e);)e=e.addWater(t.getTopWater()),t=t.removeTopWater();return[t,e]};var u=a(6253),h=a.n(u);let d=()=>{let[t,e]=(0,o.useState)(3),{gameState:a,updateGameState:s,undoGameState:n,resetGameState:l,startNewGame:c}=i(t),[u,d]=(0,o.useState)(null),g=t=>{if(null===u)d(t);else{let e=a.bottles[u],r=a.bottles[t];if(u!==t){let[o,n]=m(e,r);s({...a,bottles:a.bottles.map((e,a)=>a===u?o:a===t?n:e)})}d(null)}};return(0,r.jsxs)("div",{className:h().gameContainer,children:[(0,r.jsx)("h1",{children:"GameBoard"}),(0,r.jsx)("div",{className:h().gameBoard,children:a.bottles.map((t,e)=>(0,r.jsx)("div",{className:"".concat(h().bottle," ").concat(u===e?h().selected:""),onClick:()=>g(e),children:(0,r.jsx)(p,{waters:t.waters,maxCapacitySize:t.getMaxCapacitySize()})},e))}),(0,r.jsx)("button",{className:h().button,onClick:n,children:"1手戻る"}),(0,r.jsx)("button",{className:h().button,onClick:l,children:"リセットする"}),(0,r.jsx)("button",{className:h().button,onClick:()=>{c(t)},children:"新しいゲームを始める"}),(0,r.jsx)(C,{colorNumber:t,onColorNumberChange:t=>{e(t),c(t)}})]})},p=t=>{let e=t.maxCapacitySize-t.waters.length;return(0,r.jsxs)(r.Fragment,{children:[t.waters.map((t,e)=>(0,r.jsx)("div",{className:"".concat(h().water," ").concat(0===e?h().bottom:""),style:{backgroundColor:t.colorHexCode},children:t.colorHexCode},e)),Array.from({length:e},(t,e)=>(0,r.jsx)("div",{className:h().emptySpace},"empty-".concat(e)))]})},C=t=>(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"range",min:"2",max:"20",value:t.colorNumber,onChange:e=>t.onColorNumberChange(parseInt(e.target.value))}),(0,r.jsx)("span",{children:t.colorNumber})]})},6253:function(t){t.exports={bottle:"GameBoard_bottle__ZYvi9",selected:"GameBoard_selected__HudDg",water:"GameBoard_water__CK8F7",bottom:"GameBoard_bottom__YqCKs",emptySpace:"GameBoard_emptySpace__KAjvT",gameBoard:"GameBoard_gameBoard__zU6zC",gameContainer:"GameBoard_gameContainer__ELWz4",button:"GameBoard_button__8x7OL",celebrate:"GameBoard_celebrate__BVsmj",celebrationAnimation:"GameBoard_celebrationAnimation__rW9Uw"}}},function(t){t.O(0,[971,69,744],function(){return t(t.s=4134)}),_N_E=t.O()}]);